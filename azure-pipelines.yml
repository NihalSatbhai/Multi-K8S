trigger:
- master

pool: Azure Pipelines

steps:
- task: GoogleCloudSdkInstaller@0
  displayName: 'GCP SDK Install'
  inputs:
    version: '306.0.0'

- task: DownloadSecureFile@1
  displayName: 'Download multi-k8s.json'
  name: mySecureFile
  inputs:
    secureFile: 'multi-k8s.json'
    retryCount: '3'


- task: CmdLine@2
  displayName: 'GCloud Login'
  inputs:
    script: 'gcloud auth activate-service-account --key-file $(mySecureFile.secureFilePath)'
    workingDirectory: '$(Build.SourcesDirectory)'

# - task: ArchiveFiles@2
#   inputs:
#     rootFolderOrFile: '$(Build.SourcesDirectory)'
#     includeRootFolder: false
#     archiveType: 'zip'
#     archiveFile: '$(Build.ArtifactStagingDirectory)/$(Build.BuildNumber).zip'
#     replaceExistingArchive: true
    
# - task: PublishBuildArtifacts@1
#   displayName: 'Publish Artifact: drop'
#   inputs:
#     PathtoPublish: '$(Build.ArtifactStagingDirectory)/$(Build.BuildNumber).zip'